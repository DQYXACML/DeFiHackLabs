# Repository Guidelines

## Project Structure & Module Organization
- `src/test/YYYY-MM/` stores exploit PoCs; each file ends with `_exp.sol` and contains `setUp`/`testExploit`.
- `script/` holds forge scripts for deployments or manual runs; use `forge script`.
- `academy/` hosts written lessons; keep prose updates separated from Solidity changes.
- `lib/` tracks Foundry submodules and shared contracts; update via `forge install` only when necessary.
- Supporting artifacts (`reports/`, `generated_deploy/`, `out/`) are derived; do not commit manual edits.

## Build, Test, and Development Commands
- `pip install -r requirements.txt` installs helpers required by `add_new_entry.py`.
- `python add_new_entry.py` scaffolds new incidents and updates indexes; rerun if metadata drifts.
- `forge build` compiles all contracts with optimizer settings from `foundry.toml`.
- `forge test -vv` runs the full PoC suite; scope with `--match-path src/test/2025-08/Example_exp.sol` to iterate quickly.
- `forge script script/Exploit-template.sol -vvvv --fork-url <RPC>` dry-runs scripts; replace the template path as needed.

## Coding Style & Naming Conventions
- Solidity sources are formatted with `forge fmt`; configuration lives in `foundry.toml` (line length 120, 4-space tabs).
- Name new exploits `ProtocolName_exp.sol`; place in the incident month directory created by the helper script.
- Keep test functions descriptive (`testExploit`, `testInvariant_*`); prefer camelCase for internal helpers and CONSTANT_CASE for immutables.
- Document external addresses and tx hashes in comments generated by the scaffold; edit them only for accuracy.

## Testing Guidelines
- Extend the scaffolded `setUp` and `testExploit` flows; assert the exploit outcome (e.g., balance deltas) instead of relying solely on traces.
- Use `forge test --fork-url $RPC_URL --fork-block-number <block>` when replicating historical states; capture the block in the file header.
- Add regression checks when patching an existing PoC to protect against future refactors.

## Commit & Pull Request Guidelines
- Follow the repositoryâ€™s short imperative commit style (`Add TokenHolder PoC`, `Fix Corkprotocol_exp`); group unrelated incidents into separate commits.
- Include PR descriptions covering exploit goal, reproduction steps, and any required RPC or environment tweaks; attach run logs or screenshots when behavior is non-obvious.
- Link related issues or incident references, and request review when all `forge test` runs pass locally.

## Security & Configuration Tips
- RPC endpoints are preconfigured in `foundry.toml`; prefer the provided URLs or environment overrides instead of hardcoding secrets.
- Verify generated artifacts before sharing; the project is educational, so never expose production keys or undisclosed vulnerabilities.

