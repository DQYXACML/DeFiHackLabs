{
  "protocol": "BarleyFinance_exp",
  "year_month": "2024-01",
  "vulnerable_contract": {
    "address": "0x04c80bb477890f3021f03b068238836ee20aa0b8",
    "name": "wBARL"
  },
  "solved_constraints": [
    {
      "function": "flash",
      "signature": "flash(address,address,address,uint256,bytes)",
      "attack_pattern": "flashloan_attack",
      "constraint": {
        "function": "flash",
        "signature": "flash(address,address,address,uint256,bytes)",
        "attack_pattern": "flashloan_attack",
        "constraint": {
          "type": "inequality",
          "expression": "amount > totalLiquidity * 0.3",
          "semantics": "Large flashloan exceeding 30% of pool liquidity",
          "variables": {
            "amount": {
              "source": "function_parameter",
              "index": 2,
              "type": "uint256",
              "value_expr": "BARL.balanceOf(address(wBARL))"
            },
            "totalLiquidity": {
              "source": "storage",
              "slot": "0x3",
              "type": "uint256",
              "semantic_name": "totalLiquidity"
            }
          },
          "danger_condition": "amount > totalLiquidity * 0.3",
          "safe_condition": "amount <= totalLiquidity * 0.05"
        }
      },
      "solved": {
        "resolved": true,
        "threshold": 2583585355896554631253414,
        "state_value": 8611951186321848770844715,
        "coefficient": 0.3,
        "expression": "amount > totalLiquidity * 0.3",
        "resolved_expression": "amount > 2583585355896554631253414"
      },
      "fuzzing_seeds": [
        {
          "type": "boundary",
          "value": 2583585355896554631253415,
          "description": "刚好超过阈值 (2583585355896554631253414+1)"
        },
        {
          "type": "safe",
          "value": 430597559316092438542235,
          "description": "安全范围 (5%)"
        },
        {
          "type": "attack",
          "value": 8181353627005756332302479,
          "description": "典型攻击值 (95%)"
        },
        {
          "type": "extreme",
          "value": 8611951186321848770844715,
          "description": "完全耗尽 (100%)"
        },
        {
          "type": "zero",
          "value": 0,
          "description": "零值边界"
        }
      ]
    },
    {
      "function": "debond",
      "signature": "debond(address,uint256)",
      "attack_pattern": "large_deposit",
      "constraint": {
        "function": "debond",
        "signature": "debond(address,uint256)",
        "attack_pattern": "large_deposit",
        "constraint": {
          "type": "inequality",
          "expression": "amount > totalSupply * 0.5",
          "semantics": "Large deposit exceeding 50% of total supply",
          "variables": {
            "amount": {
              "source": "function_parameter",
              "index": 0,
              "type": "uint256",
              "value_expr": "wBARL.balanceOf(address(this))"
            },
            "totalSupply": {
              "source": "storage",
              "slot": "0x2",
              "type": "uint256",
              "semantic_name": "totalSupply"
            }
          },
          "danger_condition": "amount > totalSupply * 0.5",
          "safe_condition": "amount <= totalSupply * 0.1"
        }
      },
      "solved": {
        "resolved": true,
        "threshold": 4305975593160924385422357,
        "state_value": 8611951186321848770844714,
        "coefficient": 0.5,
        "expression": "amount > totalSupply * 0.5",
        "resolved_expression": "amount > 4305975593160924385422357"
      },
      "fuzzing_seeds": [
        {
          "type": "boundary",
          "value": 4305975593160924385422358,
          "description": "刚好超过阈值 (4305975593160924385422357+1)"
        },
        {
          "type": "safe",
          "value": 861195118632184877084471,
          "description": "安全范围 (10%)"
        },
        {
          "type": "attack",
          "value": 8181353627005756332302478,
          "description": "典型攻击值 (95%)"
        },
        {
          "type": "extreme",
          "value": 8611951186321848770844714,
          "description": "完全耗尽 (100%)"
        },
        {
          "type": "zero",
          "value": 0,
          "description": "零值边界"
        }
      ]
    },
    {
      "function": "bond",
      "signature": "bond(address,uint256)",
      "attack_pattern": "large_deposit",
      "constraint": {
        "function": "bond",
        "signature": "bond(address,uint256)",
        "attack_pattern": "large_deposit",
        "constraint": {
          "type": "inequality",
          "expression": "amount > totalSupply * 0.5",
          "semantics": "Large deposit exceeding 50% of total supply",
          "variables": {
            "amount": {
              "source": "function_parameter",
              "index": 1,
              "type": "uint256",
              "value_expr": "BARL.balanceOf(address(this))"
            },
            "totalSupply": {
              "source": "storage",
              "slot": "0x2",
              "type": "uint256",
              "semantic_name": "totalSupply"
            }
          },
          "danger_condition": "amount > totalSupply * 0.5",
          "safe_condition": "amount <= totalSupply * 0.1"
        }
      },
      "solved": {
        "resolved": true,
        "threshold": 4305975593160924385422357,
        "state_value": 8611951186321848770844714,
        "coefficient": 0.5,
        "expression": "amount > totalSupply * 0.5",
        "resolved_expression": "amount > 4305975593160924385422357"
      },
      "fuzzing_seeds": [
        {
          "type": "boundary",
          "value": 4305975593160924385422358,
          "description": "刚好超过阈值 (4305975593160924385422357+1)"
        },
        {
          "type": "safe",
          "value": 861195118632184877084471,
          "description": "安全范围 (10%)"
        },
        {
          "type": "attack",
          "value": 8181353627005756332302478,
          "description": "典型攻击值 (95%)"
        },
        {
          "type": "extreme",
          "value": 8611951186321848770844714,
          "description": "完全耗尽 (100%)"
        },
        {
          "type": "zero",
          "value": 0,
          "description": "零值边界"
        }
      ]
    }
  ],
  "param_check_rules": {
    "protocol": "BarleyFinance_exp",
    "version": "1.0.0",
    "rules": [
      {
        "function_sig": "0x4d3928ae",
        "function_name": "flash",
        "param_index": 2,
        "rule_type": "RANGE",
        "min_value": "0",
        "max_value": "2583585355896554631253414",
        "threshold": 2583585355896554631253414,
        "state_value": 8611951186321848770844715,
        "coefficient": 0.3,
        "attack_pattern": "flashloan_attack",
        "description": "Large flashloan exceeding 30% of pool liquidity"
      },
      {
        "function_sig": "0x27be7b99",
        "function_name": "debond",
        "param_index": 0,
        "rule_type": "RANGE",
        "min_value": "0",
        "max_value": "4305975593160924385422357",
        "threshold": 4305975593160924385422357,
        "state_value": 8611951186321848770844714,
        "coefficient": 0.5,
        "attack_pattern": "large_deposit",
        "description": "Large deposit exceeding 50% of total supply"
      },
      {
        "function_sig": "0xa515366a",
        "function_name": "bond",
        "param_index": 1,
        "rule_type": "RANGE",
        "min_value": "0",
        "max_value": "4305975593160924385422357",
        "threshold": 4305975593160924385422357,
        "state_value": 8611951186321848770844714,
        "coefficient": 0.5,
        "attack_pattern": "large_deposit",
        "description": "Large deposit exceeding 50% of total supply"
      }
    ],
    "metadata": {
      "generated_by": "solve_constraints.py",
      "total_rules": 3
    }
  },
  "summary": {
    "total_constraints": 3,
    "resolved_constraints": 3,
    "resolution_rate": "100.0%"
  },
  "metadata": {
    "solver_version": "1.0.0",
    "generated_by": "solve_constraints.py"
  }
}